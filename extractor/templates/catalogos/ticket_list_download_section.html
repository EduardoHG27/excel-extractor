<!-- ticket_list_download_section.html - Sección de descargas -->
<div class="card mt-4 mb-4">
    <div class="card-header bg-dark text-white">
        <h5 class="mb-0">
            <i class="bi bi-download"></i> Descargas y Backup
        </h5>
    </div>
    <div class="card-body">
        <div class="row">
            <!-- Exportar tickets filtrados -->
            <div class="col-md-6 mb-3">
                <div class="card h-100 border-primary">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary bg-opacity-10 p-3 rounded me-3">
                                <i class="bi bi-file-excel fs-1 text-primary"></i>
                            </div>
                            <div>
                                <h5 class="card-title mb-1">Exportar Tickets</h5>
                                <p class="card-text text-muted small">
                                    Descarga los tickets filtrados actualmente en formato Excel
                                </p>
                            </div>
                        </div>
                        
                        <!-- Resumen de filtros actuales -->
                        <div class="alert alert-info py-2 mb-3 small">
                            <i class="bi bi-info-circle"></i>
                            Se exportarán <strong>{{ tickets.count }}</strong> tickets con los filtros aplicados
                            {% if busqueda or estado_selected or cliente_selected %}
                                <br>
                                <span class="text-muted">
                                    Filtros: 
                                    {% if busqueda %} Búsqueda: "{{ busqueda }}" {% endif %}
                                    {% if estado_selected %} Estado: {{ estado_selected }} {% endif %}
                                    {% if cliente_selected %} Cliente seleccionado {% endif %}
                                </span>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'export_tickets_excel' %}?{{ request.GET.urlencode }}" 
                           class="btn btn-primary w-100">
                            <i class="bi bi-file-earmark-excel"></i> 
                            Exportar Tickets a Excel
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Backup completo del sistema -->
            <div class="col-md-6 mb-3">
                <div class="card h-100 border-success">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-success bg-opacity-10 p-3 rounded me-3">
                                <i class="bi bi-database fs-1 text-success"></i>
                            </div>
                            <div>
                                <h5 class="card-title mb-1">Backup Completo</h5>
                                <p class="card-text text-muted small">
                                    Descarga todas las tablas del sistema en formato CSV (archivo ZIP)
                                </p>
                            </div>
                        </div>
                        
                        <!-- Lista de tablas a respaldar -->
                        <div class="mb-3">
                            <small class="text-muted d-block mb-2">
                                <i class="bi bi-table"></i> Tablas incluidas:
                            </small>
                            <div class="d-flex flex-wrap gap-2">
                                <span class="badge bg-light text-dark p-2">
                                    <i class="bi bi-building"></i> Clientes
                                </span>
                                <span class="badge bg-light text-dark p-2">
                                    <i class="bi bi-diagram-3"></i> Proyectos
                                </span>
                                <span class="badge bg-light text-dark p-2">
                                    <i class="bi bi-tag"></i> Tipos Servicio
                                </span>
                                <span class="badge bg-light text-dark p-2">
                                    <i class="bi bi-ticket"></i> Tickets
                                </span>
                                <span class="badge bg-light text-dark p-2">
                                    <i class="bi bi-file-text"></i> Datos Excel
                                </span>
                            </div>
                        </div>
                        
                        <a href="{% url 'export_all_backup' %}" 
                           class="btn btn-success w-100">
                            <i class="bi bi-file-zip"></i> 
                            Descargar Backup Completo (ZIP)
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Descargas individuales por tabla -->
        <div class="row mt-3">
            <div class="col-12">
                <div class="card border-secondary">
                    <div class="card-header bg-secondary bg-opacity-10">
                        <h6 class="mb-0">
                            <i class="bi bi-table"></i> Descargas Individuales por Tabla
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row g-2">
                            <div class="col-md-2 col-6">
                                <a href="{% url 'export_table_csv' 'cliente' %}" 
                                   class="btn btn-outline-secondary w-100 mb-2">
                                    <i class="bi bi-building"></i> Clientes
                                </a>
                            </div>
                            <div class="col-md-2 col-6">
                                <a href="{% url 'export_table_csv' 'proyecto' %}" 
                                   class="btn btn-outline-secondary w-100 mb-2">
                                    <i class="bi bi-diagram-3"></i> Proyectos
                                </a>
                            </div>
                            <div class="col-md-2 col-6">
                                <a href="{% url 'export_table_csv' 'tiposervicio' %}" 
                                   class="btn btn-outline-secondary w-100 mb-2">
                                    <i class="bi bi-tag"></i> Tipos Servicio
                                </a>
                            </div>
                            <div class="col-md-2 col-6">
                                <a href="{% url 'export_table_csv' 'ticket' %}" 
                                   class="btn btn-outline-secondary w-100 mb-2">
                                    <i class="bi bi-ticket"></i> Tickets
                                </a>
                            </div>
                            <div class="col-md-2 col-6">
                                <a href="{% url 'export_table_csv' 'exceldata' %}" 
                                   class="btn btn-outline-secondary w-100 mb-2">
                                    <i class="bi bi-file-text"></i> Datos Excel
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Nota informativa -->
        <div class="alert alert-warning mt-3 mb-0 small">
            <div class="d-flex">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <div>
                    <strong>Nota:</strong> Los archivos se generan con la fecha y hora actual.
                    El backup completo incluye todas las tablas del sistema en formato CSV.
                    Los tickets exportados respetan los filtros aplicados en la página.
                </div>
            </div>
        </div>
    </div>
</div>